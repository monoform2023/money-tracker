<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–£—á–µ—Ç –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="icon.svg?v=2">
  
  <!-- Apple Touch Icon (–¥–ª—è iPhone/iPad) -->
  <link rel="apple-touch-icon" href="icon.svg?v=2">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Money Tracker">
  
  <!-- Android Chrome -->
  <meta name="theme-color" content="#ffffff">
  <meta name="mobile-web-app-capable" content="yes">
  
  <!-- Manifest –¥–ª—è PWA -->
  <link rel="manifest" href="manifest.json">
  
  <!-- –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
  <meta name="description" content="–ü—Ä–æ—Å—Ç–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É—á–µ—Ç–∞ –ª–∏—á–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤">
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container mt-5">
    <div class="d-flex justify-content-end mb-3">
      <button id="changeUserBtn" class="btn-user-icon" title="–°–º–µ–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
        <i class="bi bi-person-circle"></i>
        <span id="currentUserDisplay">-</span>
      </button>
    </div>

    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π -->
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h5>
        <div class="row g-3">
          <div class="col-md-4">
            <input type="text" id="description" class="form-control" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ">
          </div>
          <div class="col-md-2">
            <input type="number" id="amount" class="form-control" placeholder="–°—É–º–º–∞">
          </div>
          <div class="col-md-2">
            <select id="type" class="form-select">
              <option value="income">–î–æ—Ö–æ–¥</option>
              <option value="expense" selected>–†–∞—Å—Ö–æ–¥</option>
            </select>
          </div>
          <div class="col-md-2">
            <select id="payment" class="form-select">
              <option value="cash">–ù–∞–ª–∏—á–Ω—ã–µ</option>
              <option value="card" selected>–ë–µ–∑–Ω–∞–ª</option>
            </select>
          </div>
          <div class="col-md-2">
            <button id="addTransaction" class="btn btn-primary w-100">–î–æ–±–∞–≤–∏—Ç—å</button>
          </div>
        </div>
        
        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –≤–∏–¥–µ —Ç–∞–±–æ–≤ -->
        <div class="mt-3">
          <label class="form-label mb-2">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
          
          <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –≤–∏–¥–∏–º—ã–µ —Ç–∞–±—ã -->
          <div class="category-tabs" id="categoryTabs">
            <button type="button" class="category-tab" data-category="–ó–ü">–ó–ü</button>
            <button type="button" class="category-tab" data-category="–ê—Ä–µ–Ω–¥–∞">–ê—Ä–µ–Ω–¥–∞</button>
            <button type="button" class="category-tab" data-category="–î–æ—Å—Ç–∞–≤–∫–∞">–î–æ—Å—Ç–∞–≤–∫–∞</button>
            <button type="button" class="category-tab" data-category="–°–±–æ—Ä–∫–∞">–°–±–æ—Ä–∫–∞</button>
            <button type="button" class="category-tab" data-category="–ú–∞—Ç–µ—Ä–∏–∞–ª—ã">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</button>
            <button type="button" class="category-tab" data-category="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</button>
          </div>
          
          <!-- –°–∫—Ä—ã—Ç—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
          <div class="category-tabs-extra" id="categoryTabsExtra" style="display: none;">
            <button type="button" class="category-tab" data-category="–†–µ–∫–ª–∞–º–∞ –∏ —Å–µ—Ä–≤–∏—Å—ã">–†–µ–∫–ª–∞–º–∞</button>
            <button type="button" class="category-tab" data-category="–•–æ–∑—Ä–∞—Å—Ö–æ–¥—ã">–•–æ–∑—Ä–∞—Å—Ö–æ–¥—ã</button>
            <button type="button" class="category-tab" data-category="–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ">–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ</button>
            <button type="button" class="category-tab" data-category="–†–∞—Å—Ö–æ–¥–Ω–∏–∫–∏">–†–∞—Å—Ö–æ–¥–Ω–∏–∫–∏</button>
            <button type="button" class="category-tab" data-category="–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</button>
            <button type="button" class="category-tab" data-category="–ù–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã">–ù–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</button>
            <button type="button" class="category-tab" data-category="–ù–∞–ª–æ–≥–∏">–ù–∞–ª–æ–≥–∏</button>
          </div>
          
          <!-- –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è -->
          <div class="text-center mt-2">
            <button type="button" class="btn-expand-categories" id="expandCategoriesBtn">
              <i class="bi bi-chevron-down"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- –ë–∞–ª–∞–Ω—Å—ã -->
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">–ë–∞–ª–∞–Ω—Å—ã</h5>
        <div class="row">
          <div class="col-md-4">
            <p>–ù–∞–ª–∏—á–Ω—ã–µ: <span id="cashBalance" class="fw-bold">0 ‚ÇΩ</span></p>
          </div>
          <div class="col-md-4">
            <p>–ë–µ–∑–Ω–∞–ª: <span id="cardBalance" class="fw-bold">0 ‚ÇΩ</span></p>
          </div>
          <div class="col-md-4">
            <p>–û–±—â–∏–π –±–∞–ª–∞–Ω—Å: <span id="totalBalance" class="fw-bold">0 ‚ÇΩ</span></p>
          </div>
        </div>
      </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π -->
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title d-flex justify-content-between align-items-center">
          –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
          <button id="toggleTransactions" class="btn btn-sm btn-outline-secondary">
            –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å
          </button>
        </h5>
        <ul id="transactionList" class="list-group"></ul>
      </div>
    </div>

    <!-- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
    <div class="card mb-4">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center">
          <h5 class="card-title mb-0">–§–∏–ª—å—Ç—Ä—ã</h5>
          <div class="d-flex gap-2 align-items-center">
            <button id="analyticsBtn" class="btn btn-outline-secondary btn-sm">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
            <button type="button" class="btn-expand-filters" id="expandFiltersBtn">
              <i class="bi bi-chevron-down"></i>
            </button>
          </div>
        </div>
        <div class="filters-content" id="filtersContent" style="display: none;">
        <div class="row g-2 mt-2">
          <div class="col-md-3">
            <input type="text" id="search" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é">
          </div>
          <div class="col-md-2">
            <select id="filterType" class="form-select">
              <option value="all">–í—Å–µ —Ç–∏–ø—ã</option>
              <option value="income">–î–æ—Ö–æ–¥</option>
              <option value="expense">–†–∞—Å—Ö–æ–¥</option>
            </select>
          </div>
          <div class="col-md-2">
            <select id="filterUser" class="form-select">
              <option value="all">–í—Å–µ</option>
              <option value="–ê–ª–µ–∫—Å–µ–π">–ê–ª–µ–∫—Å–µ–π</option>
              <option value="–í–∏—Ç–∞–ª–∏–π">–í–∏—Ç–∞–ª–∏–π</option>
              <option value="–î–º–∏—Ç—Ä–∏–π">–î–º–∏—Ç—Ä–∏–π</option>
            </select>
          </div>
          <div class="col-md-2">
            <select id="filterCategory" class="form-select">
              <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
              <option value="–ó–ü">–ó–ü</option>
              <option value="–ê—Ä–µ–Ω–¥–∞">–ê—Ä–µ–Ω–¥–∞</option>
              <option value="–î–æ—Å—Ç–∞–≤–∫–∞">–î–æ—Å—Ç–∞–≤–∫–∞</option>
              <option value="–°–±–æ—Ä–∫–∞">–°–±–æ—Ä–∫–∞</option>
              <option value="–ú–∞—Ç–µ—Ä–∏–∞–ª—ã">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</option>
              <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
              <option value="–†–µ–∫–ª–∞–º–∞ –∏ —Å–µ—Ä–≤–∏—Å—ã">–†–µ–∫–ª–∞–º–∞ –∏ —Å–µ—Ä–≤–∏—Å—ã</option>
              <option value="–•–æ–∑—Ä–∞—Å—Ö–æ–¥—ã">–•–æ–∑—Ä–∞—Å—Ö–æ–¥—ã</option>
              <option value="–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ">–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ</option>
              <option value="–†–∞—Å—Ö–æ–¥–Ω–∏–∫–∏">–†–∞—Å—Ö–æ–¥–Ω–∏–∫–∏</option>
              <option value="–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</option>
              <option value="–ù–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã">–ù–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</option>
              <option value="–ù–∞–ª–æ–≥–∏">–ù–∞–ª–æ–≥–∏</option>
            </select>
          </div>
          <div class="col-md-2">
            <input type="date" id="startDate" class="form-control">
          </div>
          <div class="col-md-2">
            <input type="date" id="endDate" class="form-control">
          </div>
          <div class="col-md-1">
            <button id="filter" class="btn btn-secondary w-100">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
          </div>
        </div>
        <div class="row g-2 mt-1">
          <div class="col-md-12">
            <button id="resetFilter" class="btn btn-outline-secondary btn-sm">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
          </div>
        </div>
        <div class="mt-3 d-flex flex-wrap gap-2">
          <button id="export" class="btn btn-outline-secondary btn-sm" title="–≠–∫—Å–ø–æ—Ä—Ç –≤ XLSX">
            <i class="bi bi-download"></i>
          </button>
          <button id="archiveBtn" class="btn btn-outline-secondary btn-sm" title="–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏">
            <i class="bi bi-box-arrow-down"></i>
          </button>
          <button id="viewArchivesBtn" class="btn btn-outline-secondary btn-sm" title="–ü—Ä–æ—Å–º–æ—Ç—Ä –∞—Ä—Ö–∏–≤–æ–≤">
            <i class="bi bi-eye"></i>
          </button>
        </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ -->
  <div class="modal fade" id="analyticsModal" tabindex="-1" aria-labelledby="analyticsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="analyticsModalLabel">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-4 mb-4">
              <h6 class="text-center">–†–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h6>
              <canvas id="categoryChart"></canvas>
            </div>
            <div class="col-md-4 mb-4">
              <h6 class="text-center">–î–æ—Ö–æ–¥—ã vs –†–∞—Å—Ö–æ–¥—ã</h6>
              <canvas id="incomeExpenseChart"></canvas>
            </div>
            <div class="col-md-4 mb-4">
              <h6 class="text-center">–î–∏–Ω–∞–º–∏–∫–∞ –±–∞–ª–∞–Ω—Å–∞</h6>
              <canvas id="balanceChart"></canvas>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è -->
  <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteConfirmModalLabel">‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é?</p>
          <p class="text-muted mb-0">–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –±—É–¥–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
          <button type="button" class="btn btn-danger" id="confirmDelete">–£–¥–∞–ª–∏—Ç—å</button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
  <div class="modal fade" id="userSelectModal" tabindex="-1" aria-labelledby="userSelectModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="userSelectModalLabel">üë§ –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h5>
        </div>
        <div class="modal-body">
          <div class="d-grid gap-2">
            <button type="button" class="btn btn-secondary btn-lg user-select-btn" data-user="–ê–ª–µ–∫—Å–µ–π">–ê–ª–µ–∫—Å–µ–π</button>
            <button type="button" class="btn btn-secondary btn-lg user-select-btn" data-user="–í–∏—Ç–∞–ª–∏–π">–í–∏—Ç–∞–ª–∏–π</button>
            <button type="button" class="btn btn-secondary btn-lg user-select-btn" data-user="–î–º–∏—Ç—Ä–∏–π">–î–º–∏—Ç—Ä–∏–π</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∞—Ä—Ö–∏–≤–æ–≤ -->
  <div class="modal fade" id="archivesListModal" tabindex="-1" aria-labelledby="archivesListModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="archivesListModalLabel">üì¶ –ê—Ä—Ö–∏–≤—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="archivesList" class="list-group">
            <!-- –°–ø–∏—Å–æ–∫ –∞—Ä—Ö–∏–≤–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ -->
  <div class="modal fade" id="archiveModal" tabindex="-1" aria-labelledby="archiveModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="archiveModalLabel">‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ç–µ–∫—É—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏?</p>
          <p class="text-muted mb-0">–í—Å–µ–≥–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: <strong id="transactionCount">0</strong></p>
          <p class="text-muted">–ü–æ—Å–ª–µ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ —Ç–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫ –±—É–¥–µ—Ç –æ—á–∏—â–µ–Ω, –Ω–æ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∞—Ä—Ö–∏–≤–µ.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
          <button type="button" class="btn btn-dark" id="confirmArchive">–î–∞, –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
        </div>
      </div>
    </div>
  </div>

  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫ -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="app.js"></script>
</body>
</html>